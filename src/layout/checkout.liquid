<!DOCTYPE html>
<html lang="{{ locale }}" dir="{{ direction }}" class="{{ checkout_html_classes }}">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, height=device-height, minimum-scale=1.0, user-scalable=0">
    <meta name="referrer" content="origin">

    <title>{{ page_title }}</title>

    {{ content_for_header }}

    {{ checkout_stylesheets }}
    {{ checkout_scripts }}
    {% include 'script-google-tag-head' %}
  </head>
  <body>
    {{ skip_to_content_link }}

    <div class="banner" data-header>
      <div class="wrap">
        {{ content_for_logo }}
      </div>
    </div>

    {{ order_summary_toggle }}

    <div class="content" data-content>
      <div class="wrap">
        <div class="main" role="main">
          <div class="main__header">
            {{ content_for_logo }}
            {{ breadcrumb }}
            {{ alternative_payment_methods }}
          </div>
          <div class="main__content">
            {{ content_for_layout }}
          </div>
          <div class="main__footer">
            {{ content_for_footer }}
          </div>
        </div>
        <div class="sidebar" role="complementary">
          <div class="sidebar__header">
            {{ content_for_logo }}
          </div>
          <div class="sidebar__content">
            {{ content_for_order_summary }}
          </div>
        </div>
      </div>
    </div>
    {{ tracking_code }} 
    {% include 'checkout-expiry-callout' %}
    {% include 'checkout-customization-script' %}
    {% include 'script-google-tag-body' %}
    <script>
      var jquery = null;
      if (window.jQuery) {
        jquery = window.jQuery;
      } else if (window.Checkout && window.Checkout.$) {
        jquery = window.Checkout.$;
      }
      jquery(document).on('page:load', function() {
        var country_string = '{{ settings.delivery_country_codes }}';
        var billing_country_string = '{{ settings.billing_country_codes }}';
        if (country_string != '') {
          remove_coutry_from_dropdown(country_string,'checkout_shipping_address_country');
        }
        if (billing_country_string != '') {
          remove_coutry_from_dropdown(billing_country_string,'checkout_billing_address_country');
        }
      });
      function remove_coutry_from_dropdown(country_string,select_id)
      {
        var countries_arr= country_string.split(',');
        if (countries_arr.length != 0) {
          jquery("#"+select_id+" option").each(function() {
              if(jquery.inArray(jquery(this).attr('data-code'),countries_arr) <= -1)
              {
                  jquery(this).remove();
              }
          });
          var code = {};
          jquery("select[id='"+select_id+"'] > option").each(function () {
              if(code[this.text]) {
                  jquery(this).remove();
              } else {
                  code[this.text] = this.value;
              }
          });
          sort_options(select_id);
        }
      }
      function sort_options(select_id)
      {
        var options = jquery("#"+select_id+" option");
        var arr = options.map(function(_, o) {
            return {
                t: jquery(o).text(),
                v: o.value
            };
        }).get();
        arr.sort(function(o1, o2) {
            return o1.t > o2.t ? 1 : o1.t < o2.t ? -1 : 0;
        });
        options.each(function(i, o) {
            o.value = arr[i].v;
            jquery(o).text(arr[i].t);
        });
      }
    </script>
  </body>
</html>
